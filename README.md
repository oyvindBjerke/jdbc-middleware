# jdbc-middleware

## What is jdbc-middleware
jdbc-middleware attempts to simplify interaction with the java JDBC API, by acting as a thin abstraction layer.

## What is jdbc-middleware **not**
jdbc-middleware is **not** an ORM. It does not attempt to shield a developer from SQL.

## Features
* Simpler interactions with JDBC
* Transactions (TODO)
* Ability to interect directly with the datasource when needed
* No dependencies aside from the slf4j-api

## Requirements
* Java 8

## Code examples

### How to interact with JDBC using this library
First, instantiate an instance of the ```JdbcService```, which will be the access point for JDBC interactions using this library.

```java
import org.hsqldb.jdbc.JDBCDataSource;
import no.bjerke.jdbcmiddleware.service.JdbcService;

JDBCDataSource jdbcDataSource = new JDBCDataSource(); // lets use a HSQL datasource for this example
jdbcDataSource.setDatabase("jdbc:hsqldb:mem:db");
jdbcDataSource.setUrl("sa");
JdbcService jdbcService = new JdbcService(dataSource);
```
Congratulations, you've now got a ready to go JdbcService!

### How to select multiple rows

Say, you've got a table of employees, which have a column for ID and a column for NAME, how would one go about fetching the names of all the employees?

```java
List<String> names = jdbcService.queryForList(
    "SELECT * FROM employee",
    queryResult -> queryResult.requireString("name")
);
```
### How to select a single row

Now, we'd like to just fetch the name of the employee with the ID of 1.

```java
Optional<String> name = jdbcService.queryForSingle(
    "SELECT * FROM employee WHERE id = ?",
    queryResult -> queryResult.requireString("name"),
    1
);
```

### How about insertions?

Lets say we want to insert a row with a new name (let's assume the ID is generated by the DB in this scenario).

```java
jdbcService.insert("INSERT INTO employee (name) VALUES (?)", "Gregor Clegane");
```

Or, how about inserting a row where we want to get an auto generated key back as a result.

```java
Long id = jdbcService.insertAndReturnKey("INSERT INTO employee (name) VALUES (?)", "Jon Snow");
```

### And more

This library also supports deleting one or multiple rows, updating one or multiple rows and general update statements.

For the time being the best place to look for documentation of behaviour is in the tests of this project.
